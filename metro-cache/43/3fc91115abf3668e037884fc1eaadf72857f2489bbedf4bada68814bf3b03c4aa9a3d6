{"dependencies":[{"name":"immutability-helper","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getPresence = getPresence;\n\n  var _immutabilityHelper = _$$_REQUIRE(_dependencyMap[0], \"immutability-helper\");\n\n  var _immutabilityHelper2 = _interopRequireDefault(_immutabilityHelper);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function init(instance, channel) {\n    if (instance._component.state.pn_presence[channel]) {\n      return false;\n    }\n\n    instance._component.setState(function (prevState) {\n      return {\n        pn_presence: (0, _immutabilityHelper2.default)(prevState.pn_presence, {\n          $merge: _defineProperty({}, channel, {})\n        })\n      };\n    });\n\n    return true;\n  }\n\n  function emit(instance, channel, presence) {\n    instance._component.setState(function (prevState) {\n      return {\n        pn_presence: (0, _immutabilityHelper2.default)(prevState.pn_presence, _defineProperty({}, channel, {\n          $set: presence\n        }))\n      };\n    });\n\n    instance._broadcast.emit('presence', presence.channel, presence);\n  }\n\n  function getPresence(channel, callback) {\n    var _this = this;\n\n    this._broadcast.presence(channel, callback);\n\n    init(this, channel);\n\n    if (!this._listener.presence) {\n      this._listener.presence = function (ps) {\n        if (ps.subscription && _this._broadcast.isSubscribe('presence', ps.subscription)) {\n          emit(_this, ps.subscription, ps);\n        }\n\n        if (ps.channel && _this._broadcast.isSubscribe('presence', ps.channel)) {\n          emit(_this, ps.channel, ps);\n        }\n      };\n    }\n\n    if (this._component.state && this._component.state.pn_presence) {\n      return this._component.state.pn_presence[channel];\n    } else {\n      return {};\n    }\n  }\n});","lineCount":87,"map":[[2,0,1,0],[4,0,3,0,"Object"],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,0],[4,24,3,22,"exports"],[4,31,3,0],[4,33,3,31],[4,45,3,0],[4,47,3,45],[5,0,4,2,"value"],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,0,3,45],[6,3,3,0],[7,0,6,0,"exports"],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"getPresence"],[7,21,6,0],[7,24,6,22,"getPresence"],[7,35,6,0],[9,0,8,0],[9,6,8,4,"_immutabilityHelper"],[9,25,8,23],[9,28,8,26,"require"],[9,39,8,33],[9,81,8,0],[11,0,10,0],[11,6,10,4,"_immutabilityHelper2"],[11,26,10,24],[11,29,10,27,"_interopRequireDefault"],[11,51,10,49],[11,52,10,50,"_immutabilityHelper"],[11,71,10,49],[11,72,10,0],[13,0,12,0],[13,11,12,9,"_interopRequireDefault"],[13,33,12,0],[13,34,12,32,"obj"],[13,37,12,0],[13,39,12,37],[14,0,12,39],[14,11,12,46,"obj"],[14,14,12,49],[14,18,12,53,"obj"],[14,21,12,56],[14,22,12,57,"__esModule"],[14,32,12,46],[14,35,12,70,"obj"],[14,38,12,46],[14,41,12,76],[15,0,12,78,"default"],[15,6,12,78,"default"],[15,13,12,85],[15,15,12,87,"obj"],[16,0,12,76],[16,5,12,39],[17,0,12,95],[19,0,14,0],[19,11,14,9,"_defineProperty"],[19,26,14,0],[19,27,14,25,"obj"],[19,30,14,0],[19,32,14,30,"key"],[19,35,14,0],[19,37,14,35,"value"],[19,42,14,0],[19,44,14,42],[20,0,14,44],[20,8,14,48,"key"],[20,11,14,51],[20,15,14,55,"obj"],[20,18,14,44],[20,20,14,60],[21,0,14,62,"Object"],[21,6,14,62,"Object"],[21,12,14,68],[21,13,14,69,"defineProperty"],[21,27,14,62],[21,28,14,84,"obj"],[21,31,14,62],[21,33,14,89,"key"],[21,36,14,62],[21,38,14,94],[22,0,14,96,"value"],[22,8,14,96,"value"],[22,13,14,101],[22,15,14,103,"value"],[22,20,14,94],[23,0,14,110,"enumerable"],[23,8,14,110,"enumerable"],[23,18,14,120],[23,20,14,122],[23,24,14,94],[24,0,14,128,"configurable"],[24,8,14,128,"configurable"],[24,20,14,140],[24,22,14,142],[24,26,14,94],[25,0,14,148,"writable"],[25,8,14,148,"writable"],[25,16,14,156],[25,18,14,158],[26,0,14,94],[26,7,14,62],[27,0,14,168],[27,5,14,44],[27,11,14,174],[28,0,14,176,"obj"],[28,6,14,176,"obj"],[28,9,14,179],[28,10,14,180,"key"],[28,13,14,179],[28,14,14,176],[28,17,14,187,"value"],[28,22,14,176],[29,0,14,195],[31,0,14,196],[31,11,14,203,"obj"],[31,14,14,196],[32,0,14,209],[34,0,16,0],[34,11,16,9,"init"],[34,15,16,0],[34,16,16,14,"instance"],[34,24,16,0],[34,26,16,24,"channel"],[34,33,16,0],[34,35,16,33],[35,0,17,2],[35,8,17,6,"instance"],[35,16,17,14],[35,17,17,15,"_component"],[35,27,17,6],[35,28,17,26,"state"],[35,33,17,6],[35,34,17,32,"pn_presence"],[35,45,17,6],[35,46,17,44,"channel"],[35,53,17,6],[35,54,17,2],[35,56,17,54],[36,0,18,4],[36,13,18,11],[36,18,18,4],[37,0,19,3],[39,0,21,2,"instance"],[39,4,21,2,"instance"],[39,12,21,10],[39,13,21,11,"_component"],[39,23,21,2],[39,24,21,22,"setState"],[39,32,21,2],[39,33,21,31],[39,43,21,41,"prevState"],[39,52,21,31],[39,54,21,52],[40,0,22,4],[40,13,22,11],[41,0,23,6,"pn_presence"],[41,8,23,6,"pn_presence"],[41,19,23,17],[41,21,23,19],[41,22,23,20],[41,25,23,23,"_immutabilityHelper2"],[41,45,23,43],[41,46,23,44,"default"],[41,53,23,19],[41,55,23,53,"prevState"],[41,64,23,62],[41,65,23,63,"pn_presence"],[41,76,23,19],[41,78,23,76],[42,0,23,78,"$merge"],[42,10,23,78,"$merge"],[42,16,23,84],[42,18,23,86,"_defineProperty"],[42,33,23,101],[42,34,23,102],[42,36,23,101],[42,38,23,106,"channel"],[42,45,23,101],[42,47,23,115],[42,49,23,101],[43,0,23,76],[43,9,23,19],[44,0,22,11],[44,7,22,4],[45,0,25,3],[45,5,21,2],[47,0,27,2],[47,11,27,9],[47,15,27,2],[48,0,28,1],[50,0,30,0],[50,11,30,9,"emit"],[50,15,30,0],[50,16,30,14,"instance"],[50,24,30,0],[50,26,30,24,"channel"],[50,33,30,0],[50,35,30,33,"presence"],[50,43,30,0],[50,45,30,43],[51,0,31,2,"instance"],[51,4,31,2,"instance"],[51,12,31,10],[51,13,31,11,"_component"],[51,23,31,2],[51,24,31,22,"setState"],[51,32,31,2],[51,33,31,31],[51,43,31,41,"prevState"],[51,52,31,31],[51,54,31,52],[52,0,32,4],[52,13,32,11],[53,0,33,6,"pn_presence"],[53,8,33,6,"pn_presence"],[53,19,33,17],[53,21,33,19],[53,22,33,20],[53,25,33,23,"_immutabilityHelper2"],[53,45,33,43],[53,46,33,44,"default"],[53,53,33,19],[53,55,33,53,"prevState"],[53,64,33,62],[53,65,33,63,"pn_presence"],[53,76,33,19],[53,78,33,76,"_defineProperty"],[53,93,33,91],[53,94,33,92],[53,96,33,91],[53,98,33,96,"channel"],[53,105,33,91],[53,107,33,105],[54,0,33,107,"$set"],[54,10,33,107,"$set"],[54,14,33,111],[54,16,33,113,"presence"],[55,0,33,105],[55,9,33,91],[55,10,33,19],[56,0,32,11],[56,7,32,4],[57,0,35,3],[57,5,31,2],[59,0,37,2,"instance"],[59,4,37,2,"instance"],[59,12,37,10],[59,13,37,11,"_broadcast"],[59,23,37,2],[59,24,37,22,"emit"],[59,28,37,2],[59,29,37,27],[59,39,37,2],[59,41,37,39,"presence"],[59,49,37,47],[59,50,37,48,"channel"],[59,57,37,2],[59,59,37,57,"presence"],[59,67,37,2],[60,0,38,1],[62,0,40,0],[62,11,40,9,"getPresence"],[62,22,40,0],[62,23,40,21,"channel"],[62,30,40,0],[62,32,40,30,"callback"],[62,40,40,0],[62,42,40,40],[63,0,41,2],[63,8,41,6,"_this"],[63,13,41,11],[63,16,41,14],[63,20,41,2],[65,0,43,2],[65,9,43,7,"_broadcast"],[65,19,43,2],[65,20,43,18,"presence"],[65,28,43,2],[65,29,43,27,"channel"],[65,36,43,2],[65,38,43,36,"callback"],[65,46,43,2],[67,0,45,2,"init"],[67,4,45,2,"init"],[67,8,45,6],[67,9,45,7],[67,13,45,6],[67,15,45,13,"channel"],[67,22,45,6],[67,23,45,2],[69,0,47,2],[69,8,47,6],[69,9,47,7],[69,14,47,12,"_listener"],[69,23,47,7],[69,24,47,22,"presence"],[69,32,47,2],[69,34,47,32],[70,0,48,4],[70,11,48,9,"_listener"],[70,20,48,4],[70,21,48,19,"presence"],[70,29,48,4],[70,32,48,30],[70,42,48,40,"ps"],[70,44,48,30],[70,46,48,44],[71,0,49,6],[71,12,49,10,"ps"],[71,14,49,12],[71,15,49,13,"subscription"],[71,27,49,10],[71,31,49,29,"_this"],[71,36,49,34],[71,37,49,35,"_broadcast"],[71,47,49,29],[71,48,49,46,"isSubscribe"],[71,59,49,29],[71,60,49,58],[71,70,49,29],[71,72,49,70,"ps"],[71,74,49,72],[71,75,49,73,"subscription"],[71,87,49,29],[71,88,49,6],[71,90,49,88],[72,0,50,8,"emit"],[72,10,50,8,"emit"],[72,14,50,12],[72,15,50,13,"_this"],[72,20,50,12],[72,22,50,20,"ps"],[72,24,50,22],[72,25,50,23,"subscription"],[72,37,50,12],[72,39,50,37,"ps"],[72,41,50,12],[72,42,50,8],[73,0,51,7],[75,0,53,6],[75,12,53,10,"ps"],[75,14,53,12],[75,15,53,13,"channel"],[75,22,53,10],[75,26,53,24,"_this"],[75,31,53,29],[75,32,53,30,"_broadcast"],[75,42,53,24],[75,43,53,41,"isSubscribe"],[75,54,53,24],[75,55,53,53],[75,65,53,24],[75,67,53,65,"ps"],[75,69,53,67],[75,70,53,68,"channel"],[75,77,53,24],[75,78,53,6],[75,80,53,78],[76,0,54,8,"emit"],[76,10,54,8,"emit"],[76,14,54,12],[76,15,54,13,"_this"],[76,20,54,12],[76,22,54,20,"ps"],[76,24,54,22],[76,25,54,23,"channel"],[76,32,54,12],[76,34,54,32,"ps"],[76,36,54,12],[76,37,54,8],[77,0,55,7],[78,0,56,5],[78,7,48,4],[79,0,57,3],[81,0,59,2],[81,8,59,6],[81,13,59,11,"_component"],[81,23,59,6],[81,24,59,22,"state"],[81,29,59,6],[81,33,59,31],[81,38,59,36,"_component"],[81,48,59,31],[81,49,59,47,"state"],[81,54,59,31],[81,55,59,53,"pn_presence"],[81,66,59,2],[81,68,59,66],[82,0,60,4],[82,13,60,11],[82,18,60,16,"_component"],[82,28,60,11],[82,29,60,27,"state"],[82,34,60,11],[82,35,60,33,"pn_presence"],[82,46,60,11],[82,47,60,45,"channel"],[82,54,60,11],[82,55,60,4],[83,0,61,3],[83,5,59,2],[83,11,61,9],[84,0,62,4],[84,13,62,11],[84,15,62,4],[85,0,63,3],[86,0,64,1]],"functionMap":{"names":["<global>","_interopRequireDefault","_defineProperty","init","instance._component.setState$argument_0","emit","getPresence","_listener.presence"],"mappings":"AAA;ACW,+FD;AEE,iNF;AGE;+BCK;GDI;CHG;AKE;+BDC;GCI;CLG;AME;8BCQ;KDQ;CNQ"}},"type":"js/module"}]}
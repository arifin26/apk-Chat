{"dependencies":[{"name":"immutability-helper","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getMessage = getMessage;\n\n  var _immutabilityHelper = _$$_REQUIRE(_dependencyMap[0], \"immutability-helper\");\n\n  var _immutabilityHelper2 = _interopRequireDefault(_immutabilityHelper);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function init(component, channel) {\n    if (component.state.pn_messages[channel]) {\n      return false;\n    } else {\n      component.setState(function (prevState) {\n        return {\n          pn_messages: (0, _immutabilityHelper2.default)(prevState.pn_messages, {\n            $merge: _defineProperty({}, channel, [])\n          })\n        };\n      });\n      return true;\n    }\n  }\n\n  function emit(instance, channel, message) {\n    var messages = instance._component.state.pn_messages[channel];\n    var keepMessages = instance._keepMessages[channel];\n    messages.push(message);\n\n    if (keepMessages && messages.length > keepMessages) {\n      messages = messages.slice(messages.length - keepMessages);\n    }\n\n    instance._component.setState(function (prevState) {\n      return {\n        pn_messages: (0, _immutabilityHelper2.default)(prevState.pn_messages, _defineProperty({}, channel, {\n          $set: messages\n        }))\n      };\n    });\n\n    instance._broadcast.emit('message', channel, message);\n  }\n\n  function getMessage(channel) {\n    var _this = this;\n\n    var component = this._component;\n    var callback = void 0;\n    var keepMessages = 100;\n\n    if (arguments.length === 2 && typeof arguments[1] === 'function') {\n      callback = arguments[1];\n    } else if (arguments.length === 2 && typeof arguments[1] === 'number') {\n      keepMessages = arguments[1];\n    } else if (arguments.length === 3) {\n      callback = arguments[1];\n      keepMessages = arguments[2];\n    }\n\n    if (init(component, channel)) {\n      this._keepMessages[channel] = keepMessages;\n\n      this._autoload.getHistory(channel, callback);\n    }\n\n    this._broadcast.message(channel, callback);\n\n    if (!this._listener.message) {\n      this._listener.message = function (message) {\n        if (message.subscription && _this._broadcast.isSubscribe('message', message.subscription)) {\n          emit(_this, message.subscription, message);\n        }\n\n        if (message.channel && _this._broadcast.isSubscribe('message', message.channel)) {\n          emit(_this, message.channel, message);\n        }\n      };\n    }\n\n    if (component.state && component.state.pn_messages && component.state.pn_messages[channel]) {\n      return component.state.pn_messages[channel];\n    } else {\n      return [];\n    }\n  }\n});","lineCount":111,"map":[[2,0,1,0],[4,0,3,0,"Object"],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,0],[4,24,3,22,"exports"],[4,31,3,0],[4,33,3,31],[4,45,3,0],[4,47,3,45],[5,0,4,2,"value"],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,0,3,45],[6,3,3,0],[7,0,6,0,"exports"],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"getMessage"],[7,20,6,0],[7,23,6,21,"getMessage"],[7,33,6,0],[9,0,8,0],[9,6,8,4,"_immutabilityHelper"],[9,25,8,23],[9,28,8,26,"require"],[9,39,8,33],[9,81,8,0],[11,0,10,0],[11,6,10,4,"_immutabilityHelper2"],[11,26,10,24],[11,29,10,27,"_interopRequireDefault"],[11,51,10,49],[11,52,10,50,"_immutabilityHelper"],[11,71,10,49],[11,72,10,0],[13,0,12,0],[13,11,12,9,"_interopRequireDefault"],[13,33,12,0],[13,34,12,32,"obj"],[13,37,12,0],[13,39,12,37],[14,0,12,39],[14,11,12,46,"obj"],[14,14,12,49],[14,18,12,53,"obj"],[14,21,12,56],[14,22,12,57,"__esModule"],[14,32,12,46],[14,35,12,70,"obj"],[14,38,12,46],[14,41,12,76],[15,0,12,78,"default"],[15,6,12,78,"default"],[15,13,12,85],[15,15,12,87,"obj"],[16,0,12,76],[16,5,12,39],[17,0,12,95],[19,0,14,0],[19,11,14,9,"_defineProperty"],[19,26,14,0],[19,27,14,25,"obj"],[19,30,14,0],[19,32,14,30,"key"],[19,35,14,0],[19,37,14,35,"value"],[19,42,14,0],[19,44,14,42],[20,0,14,44],[20,8,14,48,"key"],[20,11,14,51],[20,15,14,55,"obj"],[20,18,14,44],[20,20,14,60],[21,0,14,62,"Object"],[21,6,14,62,"Object"],[21,12,14,68],[21,13,14,69,"defineProperty"],[21,27,14,62],[21,28,14,84,"obj"],[21,31,14,62],[21,33,14,89,"key"],[21,36,14,62],[21,38,14,94],[22,0,14,96,"value"],[22,8,14,96,"value"],[22,13,14,101],[22,15,14,103,"value"],[22,20,14,94],[23,0,14,110,"enumerable"],[23,8,14,110,"enumerable"],[23,18,14,120],[23,20,14,122],[23,24,14,94],[24,0,14,128,"configurable"],[24,8,14,128,"configurable"],[24,20,14,140],[24,22,14,142],[24,26,14,94],[25,0,14,148,"writable"],[25,8,14,148,"writable"],[25,16,14,156],[25,18,14,158],[26,0,14,94],[26,7,14,62],[27,0,14,168],[27,5,14,44],[27,11,14,174],[28,0,14,176,"obj"],[28,6,14,176,"obj"],[28,9,14,179],[28,10,14,180,"key"],[28,13,14,179],[28,14,14,176],[28,17,14,187,"value"],[28,22,14,176],[29,0,14,195],[31,0,14,196],[31,11,14,203,"obj"],[31,14,14,196],[32,0,14,209],[34,0,16,0],[34,11,16,9,"init"],[34,15,16,0],[34,16,16,14,"component"],[34,25,16,0],[34,27,16,25,"channel"],[34,34,16,0],[34,36,16,34],[35,0,17,2],[35,8,17,6,"component"],[35,17,17,15],[35,18,17,16,"state"],[35,23,17,6],[35,24,17,22,"pn_messages"],[35,35,17,6],[35,36,17,34,"channel"],[35,43,17,6],[35,44,17,2],[35,46,17,44],[36,0,18,4],[36,13,18,11],[36,18,18,4],[37,0,19,3],[37,5,17,2],[37,11,19,9],[38,0,20,4,"component"],[38,6,20,4,"component"],[38,15,20,13],[38,16,20,14,"setState"],[38,24,20,4],[38,25,20,23],[38,35,20,33,"prevState"],[38,44,20,23],[38,46,20,44],[39,0,21,6],[39,15,21,13],[40,0,22,8,"pn_messages"],[40,10,22,8,"pn_messages"],[40,21,22,19],[40,23,22,21],[40,24,22,22],[40,27,22,25,"_immutabilityHelper2"],[40,47,22,45],[40,48,22,46,"default"],[40,55,22,21],[40,57,22,55,"prevState"],[40,66,22,64],[40,67,22,65,"pn_messages"],[40,78,22,21],[40,80,22,78],[41,0,22,80,"$merge"],[41,12,22,80,"$merge"],[41,18,22,86],[41,20,22,88,"_defineProperty"],[41,35,22,103],[41,36,22,104],[41,38,22,103],[41,40,22,108,"channel"],[41,47,22,103],[41,49,22,117],[41,51,22,103],[42,0,22,78],[42,11,22,21],[43,0,21,13],[43,9,21,6],[44,0,24,5],[44,7,20,4],[45,0,26,4],[45,13,26,11],[45,17,26,4],[46,0,27,3],[47,0,28,1],[49,0,30,0],[49,11,30,9,"emit"],[49,15,30,0],[49,16,30,14,"instance"],[49,24,30,0],[49,26,30,24,"channel"],[49,33,30,0],[49,35,30,33,"message"],[49,42,30,0],[49,44,30,42],[50,0,31,2],[50,8,31,6,"messages"],[50,16,31,14],[50,19,31,17,"instance"],[50,27,31,25],[50,28,31,26,"_component"],[50,38,31,17],[50,39,31,37,"state"],[50,44,31,17],[50,45,31,43,"pn_messages"],[50,56,31,17],[50,57,31,55,"channel"],[50,64,31,17],[50,65,31,2],[51,0,32,2],[51,8,32,6,"keepMessages"],[51,20,32,18],[51,23,32,21,"instance"],[51,31,32,29],[51,32,32,30,"_keepMessages"],[51,45,32,21],[51,46,32,44,"channel"],[51,53,32,21],[51,54,32,2],[52,0,34,2,"messages"],[52,4,34,2,"messages"],[52,12,34,10],[52,13,34,11,"push"],[52,17,34,2],[52,18,34,16,"message"],[52,25,34,2],[54,0,36,2],[54,8,36,6,"keepMessages"],[54,20,36,18],[54,24,36,22,"messages"],[54,32,36,30],[54,33,36,31,"length"],[54,39,36,22],[54,42,36,40,"keepMessages"],[54,54,36,2],[54,56,36,54],[55,0,37,4,"messages"],[55,6,37,4,"messages"],[55,14,37,12],[55,17,37,15,"messages"],[55,25,37,23],[55,26,37,24,"slice"],[55,31,37,15],[55,32,37,30,"messages"],[55,40,37,38],[55,41,37,39,"length"],[55,47,37,30],[55,50,37,48,"keepMessages"],[55,62,37,15],[55,63,37,4],[56,0,38,3],[58,0,40,2,"instance"],[58,4,40,2,"instance"],[58,12,40,10],[58,13,40,11,"_component"],[58,23,40,2],[58,24,40,22,"setState"],[58,32,40,2],[58,33,40,31],[58,43,40,41,"prevState"],[58,52,40,31],[58,54,40,52],[59,0,41,4],[59,13,41,11],[60,0,42,6,"pn_messages"],[60,8,42,6,"pn_messages"],[60,19,42,17],[60,21,42,19],[60,22,42,20],[60,25,42,23,"_immutabilityHelper2"],[60,45,42,43],[60,46,42,44,"default"],[60,53,42,19],[60,55,42,53,"prevState"],[60,64,42,62],[60,65,42,63,"pn_messages"],[60,76,42,19],[60,78,42,76,"_defineProperty"],[60,93,42,91],[60,94,42,92],[60,96,42,91],[60,98,42,96,"channel"],[60,105,42,91],[60,107,42,105],[61,0,42,107,"$set"],[61,10,42,107,"$set"],[61,14,42,111],[61,16,42,113,"messages"],[62,0,42,105],[62,9,42,91],[62,10,42,19],[63,0,41,11],[63,7,41,4],[64,0,44,3],[64,5,40,2],[66,0,46,2,"instance"],[66,4,46,2,"instance"],[66,12,46,10],[66,13,46,11,"_broadcast"],[66,23,46,2],[66,24,46,22,"emit"],[66,28,46,2],[66,29,46,27],[66,38,46,2],[66,40,46,38,"channel"],[66,47,46,2],[66,49,46,47,"message"],[66,56,46,2],[67,0,47,1],[69,0,49,0],[69,11,49,9,"getMessage"],[69,21,49,0],[69,22,49,20,"channel"],[69,29,49,0],[69,31,49,29],[70,0,50,2],[70,8,50,6,"_this"],[70,13,50,11],[70,16,50,14],[70,20,50,2],[72,0,52,2],[72,8,52,6,"component"],[72,17,52,15],[72,20,52,18],[72,25,52,23,"_component"],[72,35,52,2],[73,0,53,2],[73,8,53,6,"callback"],[73,16,53,14],[73,19,53,17],[73,24,53,22],[73,25,53,2],[74,0,54,2],[74,8,54,6,"keepMessages"],[74,20,54,18],[74,23,54,21],[74,26,54,2],[76,0,56,2],[76,8,56,6,"arguments"],[76,17,56,15],[76,18,56,16,"length"],[76,24,56,6],[76,29,56,27],[76,30,56,6],[76,34,56,32],[76,41,56,39,"arguments"],[76,50,56,48],[76,51,56,49],[76,52,56,48],[76,53,56,32],[76,58,56,56],[76,68,56,2],[76,70,56,68],[77,0,57,4,"callback"],[77,6,57,4,"callback"],[77,14,57,12],[77,17,57,15,"arguments"],[77,26,57,24],[77,27,57,25],[77,28,57,24],[77,29,57,4],[78,0,58,3],[78,5,56,2],[78,11,58,9],[78,15,58,13,"arguments"],[78,24,58,22],[78,25,58,23,"length"],[78,31,58,13],[78,36,58,34],[78,37,58,13],[78,41,58,39],[78,48,58,46,"arguments"],[78,57,58,55],[78,58,58,56],[78,59,58,55],[78,60,58,39],[78,65,58,63],[78,73,58,9],[78,75,58,73],[79,0,59,4,"keepMessages"],[79,6,59,4,"keepMessages"],[79,18,59,16],[79,21,59,19,"arguments"],[79,30,59,28],[79,31,59,29],[79,32,59,28],[79,33,59,4],[80,0,60,3],[80,5,58,9],[80,11,60,9],[80,15,60,13,"arguments"],[80,24,60,22],[80,25,60,23,"length"],[80,31,60,13],[80,36,60,34],[80,37,60,9],[80,39,60,37],[81,0,61,4,"callback"],[81,6,61,4,"callback"],[81,14,61,12],[81,17,61,15,"arguments"],[81,26,61,24],[81,27,61,25],[81,28,61,24],[81,29,61,4],[82,0,62,4,"keepMessages"],[82,6,62,4,"keepMessages"],[82,18,62,16],[82,21,62,19,"arguments"],[82,30,62,28],[82,31,62,29],[82,32,62,28],[82,33,62,4],[83,0,63,3],[85,0,65,2],[85,8,65,6,"init"],[85,12,65,10],[85,13,65,11,"component"],[85,22,65,10],[85,24,65,22,"channel"],[85,31,65,10],[85,32,65,2],[85,34,65,32],[86,0,66,4],[86,11,66,9,"_keepMessages"],[86,24,66,4],[86,25,66,23,"channel"],[86,32,66,4],[86,36,66,34,"keepMessages"],[86,48,66,4],[88,0,67,4],[88,11,67,9,"_autoload"],[88,20,67,4],[88,21,67,19,"getHistory"],[88,31,67,4],[88,32,67,30,"channel"],[88,39,67,4],[88,41,67,39,"callback"],[88,49,67,4],[89,0,68,3],[91,0,70,2],[91,9,70,7,"_broadcast"],[91,19,70,2],[91,20,70,18,"message"],[91,27,70,2],[91,28,70,26,"channel"],[91,35,70,2],[91,37,70,35,"callback"],[91,45,70,2],[93,0,72,2],[93,8,72,6],[93,9,72,7],[93,14,72,12,"_listener"],[93,23,72,7],[93,24,72,22,"message"],[93,31,72,2],[93,33,72,31],[94,0,73,4],[94,11,73,9,"_listener"],[94,20,73,4],[94,21,73,19,"message"],[94,28,73,4],[94,31,73,29],[94,41,73,39,"message"],[94,48,73,29],[94,50,73,48],[95,0,74,6],[95,12,74,10,"message"],[95,19,74,17],[95,20,74,18,"subscription"],[95,32,74,10],[95,36,74,34,"_this"],[95,41,74,39],[95,42,74,40,"_broadcast"],[95,52,74,34],[95,53,74,51,"isSubscribe"],[95,64,74,34],[95,65,74,63],[95,74,74,34],[95,76,74,74,"message"],[95,83,74,81],[95,84,74,82,"subscription"],[95,96,74,34],[95,97,74,6],[95,99,74,97],[96,0,75,8,"emit"],[96,10,75,8,"emit"],[96,14,75,12],[96,15,75,13,"_this"],[96,20,75,12],[96,22,75,20,"message"],[96,29,75,27],[96,30,75,28,"subscription"],[96,42,75,12],[96,44,75,42,"message"],[96,51,75,12],[96,52,75,8],[97,0,76,7],[99,0,78,6],[99,12,78,10,"message"],[99,19,78,17],[99,20,78,18,"channel"],[99,27,78,10],[99,31,78,29,"_this"],[99,36,78,34],[99,37,78,35,"_broadcast"],[99,47,78,29],[99,48,78,46,"isSubscribe"],[99,59,78,29],[99,60,78,58],[99,69,78,29],[99,71,78,69,"message"],[99,78,78,76],[99,79,78,77,"channel"],[99,86,78,29],[99,87,78,6],[99,89,78,87],[100,0,79,8,"emit"],[100,10,79,8,"emit"],[100,14,79,12],[100,15,79,13,"_this"],[100,20,79,12],[100,22,79,20,"message"],[100,29,79,27],[100,30,79,28,"channel"],[100,37,79,12],[100,39,79,37,"message"],[100,46,79,12],[100,47,79,8],[101,0,80,7],[102,0,81,5],[102,7,73,4],[103,0,82,3],[105,0,84,2],[105,8,84,6,"component"],[105,17,84,15],[105,18,84,16,"state"],[105,23,84,6],[105,27,84,25,"component"],[105,36,84,34],[105,37,84,35,"state"],[105,42,84,25],[105,43,84,41,"pn_messages"],[105,54,84,6],[105,58,84,56,"component"],[105,67,84,65],[105,68,84,66,"state"],[105,73,84,56],[105,74,84,72,"pn_messages"],[105,85,84,56],[105,86,84,84,"channel"],[105,93,84,56],[105,94,84,2],[105,96,84,94],[106,0,85,4],[106,13,85,11,"component"],[106,22,85,20],[106,23,85,21,"state"],[106,28,85,11],[106,29,85,27,"pn_messages"],[106,40,85,11],[106,41,85,39,"channel"],[106,48,85,11],[106,49,85,4],[107,0,86,3],[107,5,84,2],[107,11,86,9],[108,0,87,4],[108,13,87,11],[108,15,87,4],[109,0,88,3],[110,0,89,1]],"functionMap":{"names":["<global>","_interopRequireDefault","_defineProperty","init","component.setState$argument_0","emit","instance._component.setState$argument_0","getMessage","_listener.message"],"mappings":"AAA;ACW,+FD;AEE,iNF;AGE;uBCI;KDI;CHI;AKE;+BCU;GDI;CLG;AOE;6BCwB;KDQ;CPQ"}},"type":"js/module"}]}
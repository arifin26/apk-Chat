{"dependencies":[{"name":"../flow_interfaces","data":{"isAsync":false}},{"name":"../constants/operations","data":{"isAsync":false}},{"name":"../utils","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getOperation = getOperation;\n  exports.validateParams = validateParams;\n  exports.getURL = getURL;\n  exports.getRequestTimeout = getRequestTimeout;\n  exports.isAuthSupported = isAuthSupported;\n  exports.prepareParams = prepareParams;\n  exports.handleResponse = handleResponse;\n\n  var _flow_interfaces = _$$_REQUIRE(_dependencyMap[0], \"../flow_interfaces\");\n\n  var _operations = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"../constants/operations\"));\n\n  var _utils = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"../utils\"));\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n\n  function getOperation() {\n    return _operations[\"default\"].PNSubscribeOperation;\n  }\n\n  function validateParams(modules) {\n    var config = modules.config;\n    if (!config.subscribeKey) return 'Missing Subscribe Key';\n  }\n\n  function getURL(modules, incomingParams) {\n    var config = modules.config;\n    var _incomingParams$chann = incomingParams.channels,\n        channels = _incomingParams$chann === void 0 ? [] : _incomingParams$chann;\n    var stringifiedChannels = channels.length > 0 ? channels.join(',') : ',';\n    return \"/v2/subscribe/\".concat(config.subscribeKey, \"/\").concat(_utils[\"default\"].encodeString(stringifiedChannels), \"/0\");\n  }\n\n  function getRequestTimeout(_ref) {\n    var config = _ref.config;\n    return config.getSubscribeTimeout();\n  }\n\n  function isAuthSupported() {\n    return true;\n  }\n\n  function prepareParams(_ref2, incomingParams) {\n    var config = _ref2.config;\n    var state = incomingParams.state,\n        _incomingParams$chann2 = incomingParams.channelGroups,\n        channelGroups = _incomingParams$chann2 === void 0 ? [] : _incomingParams$chann2,\n        timetoken = incomingParams.timetoken,\n        filterExpression = incomingParams.filterExpression,\n        region = incomingParams.region;\n    var params = {\n      heartbeat: config.getPresenceTimeout()\n    };\n\n    if (channelGroups.length > 0) {\n      params['channel-group'] = channelGroups.join(',');\n    }\n\n    if (filterExpression && filterExpression.length > 0) {\n      params['filter-expr'] = filterExpression;\n    }\n\n    if (Object.keys(state).length) {\n      params.state = JSON.stringify(state);\n    }\n\n    if (timetoken) {\n      params.tt = timetoken;\n    }\n\n    if (region) {\n      params.tr = region;\n    }\n\n    return params;\n  }\n\n  function handleResponse(modules, serverResponse) {\n    var messages = [];\n    serverResponse.m.forEach(function (rawMessage) {\n      var publishMetaData = {\n        publishTimetoken: rawMessage.p.t,\n        region: rawMessage.p.r\n      };\n      var parsedMessage = {\n        shard: parseInt(rawMessage.a, 10),\n        subscriptionMatch: rawMessage.b,\n        channel: rawMessage.c,\n        messageType: rawMessage.e,\n        payload: rawMessage.d,\n        flags: rawMessage.f,\n        issuingClientId: rawMessage.i,\n        subscribeKey: rawMessage.k,\n        originationTimetoken: rawMessage.o,\n        userMetadata: rawMessage.u,\n        publishMetaData: publishMetaData\n      };\n      messages.push(parsedMessage);\n    });\n    var metadata = {\n      timetoken: serverResponse.t.t,\n      region: serverResponse.t.r\n    };\n    return {\n      messages: messages,\n      metadata: metadata\n    };\n  }\n});","lineCount":119,"map":[[2,0,1,0],[4,0,3,0,"Object"],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,0],[4,24,3,22,"exports"],[4,31,3,0],[4,33,3,31],[4,45,3,0],[4,47,3,45],[5,0,4,2,"value"],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,0,3,45],[6,3,3,0],[7,0,6,0,"exports"],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"getOperation"],[7,22,6,0],[7,25,6,23,"getOperation"],[7,37,6,0],[8,0,7,0,"exports"],[8,2,7,0,"exports"],[8,9,7,7],[8,10,7,8,"validateParams"],[8,24,7,0],[8,27,7,25,"validateParams"],[8,41,7,0],[9,0,8,0,"exports"],[9,2,8,0,"exports"],[9,9,8,7],[9,10,8,8,"getURL"],[9,16,8,0],[9,19,8,17,"getURL"],[9,25,8,0],[10,0,9,0,"exports"],[10,2,9,0,"exports"],[10,9,9,7],[10,10,9,8,"getRequestTimeout"],[10,27,9,0],[10,30,9,28,"getRequestTimeout"],[10,47,9,0],[11,0,10,0,"exports"],[11,2,10,0,"exports"],[11,9,10,7],[11,10,10,8,"isAuthSupported"],[11,25,10,0],[11,28,10,26,"isAuthSupported"],[11,43,10,0],[12,0,11,0,"exports"],[12,2,11,0,"exports"],[12,9,11,7],[12,10,11,8,"prepareParams"],[12,23,11,0],[12,26,11,24,"prepareParams"],[12,39,11,0],[13,0,12,0,"exports"],[13,2,12,0,"exports"],[13,9,12,7],[13,10,12,8,"handleResponse"],[13,24,12,0],[13,27,12,25,"handleResponse"],[13,41,12,0],[15,0,14,0],[15,6,14,4,"_flow_interfaces"],[15,22,14,20],[15,25,14,23,"require"],[15,36,14,30],[15,77,14,0],[17,0,16,0],[17,6,16,4,"_operations"],[17,17,16,15],[17,20,16,18,"_interopRequireDefault"],[17,42,16,40],[17,43,16,41,"require"],[17,54,16,48],[17,100,16,40],[17,101,16,0],[19,0,18,0],[19,6,18,4,"_utils"],[19,12,18,10],[19,15,18,13,"_interopRequireDefault"],[19,37,18,35],[19,38,18,36,"require"],[19,49,18,43],[19,80,18,35],[19,81,18,0],[21,0,20,0],[21,11,20,9,"_interopRequireDefault"],[21,33,20,0],[21,34,20,32,"obj"],[21,37,20,0],[21,39,20,37],[22,0,20,39],[22,11,20,46,"obj"],[22,14,20,49],[22,18,20,53,"obj"],[22,21,20,56],[22,22,20,57,"__esModule"],[22,32,20,46],[22,35,20,70,"obj"],[22,38,20,46],[22,41,20,76],[23,0,20,78],[23,17,20,89,"obj"],[24,0,20,76],[24,5,20,39],[25,0,20,97],[27,0,22,0],[27,11,22,9,"getOperation"],[27,23,22,0],[27,26,22,24],[28,0,23,2],[28,11,23,9,"_operations"],[28,22,23,20],[28,23,23,21],[28,32,23,20],[28,33,23,9],[28,34,23,32,"PNSubscribeOperation"],[28,54,23,2],[29,0,24,1],[31,0,26,0],[31,11,26,9,"validateParams"],[31,25,26,0],[31,26,26,24,"modules"],[31,33,26,0],[31,35,26,33],[32,0,27,2],[32,8,27,6,"config"],[32,14,27,12],[32,17,27,15,"modules"],[32,24,27,22],[32,25,27,23,"config"],[32,31,27,2],[33,0,28,2],[33,8,28,6],[33,9,28,7,"config"],[33,15,28,13],[33,16,28,14,"subscribeKey"],[33,28,28,2],[33,30,28,28],[33,37,28,35],[33,60,28,28],[34,0,29,1],[36,0,31,0],[36,11,31,9,"getURL"],[36,17,31,0],[36,18,31,16,"modules"],[36,25,31,0],[36,27,31,25,"incomingParams"],[36,41,31,0],[36,43,31,41],[37,0,32,2],[37,8,32,6,"config"],[37,14,32,12],[37,17,32,15,"modules"],[37,24,32,22],[37,25,32,23,"config"],[37,31,32,2],[38,0,33,2],[38,8,33,6,"_incomingParams$chann"],[38,29,33,27],[38,32,33,30,"incomingParams"],[38,46,33,44],[38,47,33,45,"channels"],[38,55,33,2],[39,0,33,2],[39,8,34,6,"channels"],[39,16,34,14],[39,19,34,17,"_incomingParams$chann"],[39,40,34,38],[39,45,34,43],[39,50,34,48],[39,51,34,17],[39,54,34,52],[39,56,34,17],[39,59,34,57,"_incomingParams$chann"],[39,80,33,2],[40,0,35,2],[40,8,35,6,"stringifiedChannels"],[40,27,35,25],[40,30,35,28,"channels"],[40,38,35,36],[40,39,35,37,"length"],[40,45,35,28],[40,48,35,46],[40,49,35,28],[40,52,35,50,"channels"],[40,60,35,58],[40,61,35,59,"join"],[40,65,35,50],[40,66,35,64],[40,69,35,50],[40,70,35,28],[40,73,35,71],[40,76,35,2],[41,0,36,2],[41,11,36,9],[41,28,36,26,"concat"],[41,34,36,9],[41,35,36,33,"config"],[41,41,36,39],[41,42,36,40,"subscribeKey"],[41,54,36,9],[41,56,36,54],[41,59,36,9],[41,61,36,59,"concat"],[41,67,36,9],[41,68,36,66,"_utils"],[41,74,36,72],[41,75,36,73],[41,84,36,72],[41,85,36,66],[41,86,36,84,"encodeString"],[41,98,36,66],[41,99,36,97,"stringifiedChannels"],[41,118,36,66],[41,119,36,9],[41,121,36,119],[41,125,36,9],[41,126,36,2],[42,0,37,1],[44,0,39,0],[44,11,39,9,"getRequestTimeout"],[44,28,39,0],[44,29,39,27,"_ref"],[44,33,39,0],[44,35,39,33],[45,0,40,2],[45,8,40,6,"config"],[45,14,40,12],[45,17,40,15,"_ref"],[45,21,40,19],[45,22,40,20,"config"],[45,28,40,2],[46,0,41,2],[46,11,41,9,"config"],[46,17,41,15],[46,18,41,16,"getSubscribeTimeout"],[46,37,41,9],[46,39,41,2],[47,0,42,1],[49,0,44,0],[49,11,44,9,"isAuthSupported"],[49,26,44,0],[49,29,44,27],[50,0,45,2],[50,11,45,9],[50,15,45,2],[51,0,46,1],[53,0,48,0],[53,11,48,9,"prepareParams"],[53,24,48,0],[53,25,48,23,"_ref2"],[53,30,48,0],[53,32,48,30,"incomingParams"],[53,46,48,0],[53,48,48,46],[54,0,49,2],[54,8,49,6,"config"],[54,14,49,12],[54,17,49,15,"_ref2"],[54,22,49,20],[54,23,49,21,"config"],[54,29,49,2],[55,0,50,2],[55,8,50,6,"state"],[55,13,50,11],[55,16,50,14,"incomingParams"],[55,30,50,28],[55,31,50,29,"state"],[55,36,50,2],[56,0,50,2],[56,8,51,6,"_incomingParams$chann2"],[56,30,51,28],[56,33,51,31,"incomingParams"],[56,47,51,45],[56,48,51,46,"channelGroups"],[56,61,50,2],[57,0,50,2],[57,8,52,6,"channelGroups"],[57,21,52,19],[57,24,52,22,"_incomingParams$chann2"],[57,46,52,44],[57,51,52,49],[57,56,52,54],[57,57,52,22],[57,60,52,58],[57,62,52,22],[57,65,52,63,"_incomingParams$chann2"],[57,87,50,2],[58,0,50,2],[58,8,53,6,"timetoken"],[58,17,53,15],[58,20,53,18,"incomingParams"],[58,34,53,32],[58,35,53,33,"timetoken"],[58,44,50,2],[59,0,50,2],[59,8,54,6,"filterExpression"],[59,24,54,22],[59,27,54,25,"incomingParams"],[59,41,54,39],[59,42,54,40,"filterExpression"],[59,58,50,2],[60,0,50,2],[60,8,55,6,"region"],[60,14,55,12],[60,17,55,15,"incomingParams"],[60,31,55,29],[60,32,55,30,"region"],[60,38,50,2],[61,0,56,2],[61,8,56,6,"params"],[61,14,56,12],[61,17,56,15],[62,0,57,4,"heartbeat"],[62,6,57,4,"heartbeat"],[62,15,57,13],[62,17,57,15,"config"],[62,23,57,21],[62,24,57,22,"getPresenceTimeout"],[62,42,57,15],[63,0,56,15],[63,5,56,2],[65,0,60,2],[65,8,60,6,"channelGroups"],[65,21,60,19],[65,22,60,20,"length"],[65,28,60,6],[65,31,60,29],[65,32,60,2],[65,34,60,32],[66,0,61,4,"params"],[66,6,61,4,"params"],[66,12,61,10],[66,13,61,11],[66,28,61,10],[66,29,61,4],[66,32,61,30,"channelGroups"],[66,45,61,43],[66,46,61,44,"join"],[66,50,61,30],[66,51,61,49],[66,54,61,30],[66,55,61,4],[67,0,62,3],[69,0,64,2],[69,8,64,6,"filterExpression"],[69,24,64,22],[69,28,64,26,"filterExpression"],[69,44,64,42],[69,45,64,43,"length"],[69,51,64,26],[69,54,64,52],[69,55,64,2],[69,57,64,55],[70,0,65,4,"params"],[70,6,65,4,"params"],[70,12,65,10],[70,13,65,11],[70,26,65,10],[70,27,65,4],[70,30,65,28,"filterExpression"],[70,46,65,4],[71,0,66,3],[73,0,68,2],[73,8,68,6,"Object"],[73,14,68,12],[73,15,68,13,"keys"],[73,19,68,6],[73,20,68,18,"state"],[73,25,68,6],[73,27,68,25,"length"],[73,33,68,2],[73,35,68,33],[74,0,69,4,"params"],[74,6,69,4,"params"],[74,12,69,10],[74,13,69,11,"state"],[74,18,69,4],[74,21,69,19,"JSON"],[74,25,69,23],[74,26,69,24,"stringify"],[74,35,69,19],[74,36,69,34,"state"],[74,41,69,19],[74,42,69,4],[75,0,70,3],[77,0,72,2],[77,8,72,6,"timetoken"],[77,17,72,2],[77,19,72,17],[78,0,73,4,"params"],[78,6,73,4,"params"],[78,12,73,10],[78,13,73,11,"tt"],[78,15,73,4],[78,18,73,16,"timetoken"],[78,27,73,4],[79,0,74,3],[81,0,76,2],[81,8,76,6,"region"],[81,14,76,2],[81,16,76,14],[82,0,77,4,"params"],[82,6,77,4,"params"],[82,12,77,10],[82,13,77,11,"tr"],[82,15,77,4],[82,18,77,16,"region"],[82,24,77,4],[83,0,78,3],[85,0,80,2],[85,11,80,9,"params"],[85,17,80,2],[86,0,81,1],[88,0,83,0],[88,11,83,9,"handleResponse"],[88,25,83,0],[88,26,83,24,"modules"],[88,33,83,0],[88,35,83,33,"serverResponse"],[88,49,83,0],[88,51,83,49],[89,0,84,2],[89,8,84,6,"messages"],[89,16,84,14],[89,19,84,17],[89,21,84,2],[90,0,85,2,"serverResponse"],[90,4,85,2,"serverResponse"],[90,18,85,16],[90,19,85,17,"m"],[90,20,85,2],[90,21,85,19,"forEach"],[90,28,85,2],[90,29,85,27],[90,39,85,37,"rawMessage"],[90,49,85,27],[90,51,85,49],[91,0,86,4],[91,10,86,8,"publishMetaData"],[91,25,86,23],[91,28,86,26],[92,0,87,6,"publishTimetoken"],[92,8,87,6,"publishTimetoken"],[92,24,87,22],[92,26,87,24,"rawMessage"],[92,36,87,34],[92,37,87,35,"p"],[92,38,87,24],[92,39,87,37,"t"],[92,40,86,26],[93,0,88,6,"region"],[93,8,88,6,"region"],[93,14,88,12],[93,16,88,14,"rawMessage"],[93,26,88,24],[93,27,88,25,"p"],[93,28,88,14],[93,29,88,27,"r"],[94,0,86,26],[94,7,86,4],[95,0,90,4],[95,10,90,8,"parsedMessage"],[95,23,90,21],[95,26,90,24],[96,0,91,6,"shard"],[96,8,91,6,"shard"],[96,13,91,11],[96,15,91,13,"parseInt"],[96,23,91,21],[96,24,91,22,"rawMessage"],[96,34,91,32],[96,35,91,33,"a"],[96,36,91,21],[96,38,91,36],[96,40,91,21],[96,41,90,24],[97,0,92,6,"subscriptionMatch"],[97,8,92,6,"subscriptionMatch"],[97,25,92,23],[97,27,92,25,"rawMessage"],[97,37,92,35],[97,38,92,36,"b"],[97,39,90,24],[98,0,93,6,"channel"],[98,8,93,6,"channel"],[98,15,93,13],[98,17,93,15,"rawMessage"],[98,27,93,25],[98,28,93,26,"c"],[98,29,90,24],[99,0,94,6,"messageType"],[99,8,94,6,"messageType"],[99,19,94,17],[99,21,94,19,"rawMessage"],[99,31,94,29],[99,32,94,30,"e"],[99,33,90,24],[100,0,95,6,"payload"],[100,8,95,6,"payload"],[100,15,95,13],[100,17,95,15,"rawMessage"],[100,27,95,25],[100,28,95,26,"d"],[100,29,90,24],[101,0,96,6,"flags"],[101,8,96,6,"flags"],[101,13,96,11],[101,15,96,13,"rawMessage"],[101,25,96,23],[101,26,96,24,"f"],[101,27,90,24],[102,0,97,6,"issuingClientId"],[102,8,97,6,"issuingClientId"],[102,23,97,21],[102,25,97,23,"rawMessage"],[102,35,97,33],[102,36,97,34,"i"],[102,37,90,24],[103,0,98,6,"subscribeKey"],[103,8,98,6,"subscribeKey"],[103,20,98,18],[103,22,98,20,"rawMessage"],[103,32,98,30],[103,33,98,31,"k"],[103,34,90,24],[104,0,99,6,"originationTimetoken"],[104,8,99,6,"originationTimetoken"],[104,28,99,26],[104,30,99,28,"rawMessage"],[104,40,99,38],[104,41,99,39,"o"],[104,42,90,24],[105,0,100,6,"userMetadata"],[105,8,100,6,"userMetadata"],[105,20,100,18],[105,22,100,20,"rawMessage"],[105,32,100,30],[105,33,100,31,"u"],[105,34,90,24],[106,0,101,6,"publishMetaData"],[106,8,101,6,"publishMetaData"],[106,23,101,21],[106,25,101,23,"publishMetaData"],[107,0,90,24],[107,7,90,4],[108,0,103,4,"messages"],[108,6,103,4,"messages"],[108,14,103,12],[108,15,103,13,"push"],[108,19,103,4],[108,20,103,18,"parsedMessage"],[108,33,103,4],[109,0,104,3],[109,5,85,2],[110,0,105,2],[110,8,105,6,"metadata"],[110,16,105,14],[110,19,105,17],[111,0,106,4,"timetoken"],[111,6,106,4,"timetoken"],[111,15,106,13],[111,17,106,15,"serverResponse"],[111,31,106,29],[111,32,106,30,"t"],[111,33,106,15],[111,34,106,32,"t"],[111,35,105,17],[112,0,107,4,"region"],[112,6,107,4,"region"],[112,12,107,10],[112,14,107,12,"serverResponse"],[112,28,107,26],[112,29,107,27,"t"],[112,30,107,12],[112,31,107,29,"r"],[113,0,105,17],[113,5,105,2],[114,0,109,2],[114,11,109,9],[115,0,110,4,"messages"],[115,6,110,4,"messages"],[115,14,110,12],[115,16,110,14,"messages"],[115,24,109,9],[116,0,111,4,"metadata"],[116,6,111,4,"metadata"],[116,14,111,12],[116,16,111,14,"metadata"],[117,0,109,9],[117,5,109,2],[118,0,113,1]],"functionMap":{"names":["<global>","_interopRequireDefault","getOperation","validateParams","getURL","getRequestTimeout","isAuthSupported","prepareParams","handleResponse","serverResponse.m.forEach$argument_0"],"mappings":"AAA;ACmB,iGD;AEE;CFE;AGE;CHG;AIE;CJM;AKE;CLG;AME;CNE;AOE;CPiC;AQE;2BCE;GDmB;CRS"}},"type":"js/module"}]}
{"dependencies":[{"name":"../../flow_interfaces","data":{"isAsync":false}},{"name":"../../constants/operations","data":{"isAsync":false}},{"name":"../../utils","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getOperation = getOperation;\n  exports.validateParams = validateParams;\n  exports.getURL = getURL;\n  exports.getRequestTimeout = getRequestTimeout;\n  exports.isAuthSupported = isAuthSupported;\n  exports.prepareParams = prepareParams;\n  exports.handleResponse = handleResponse;\n\n  var _flow_interfaces = _$$_REQUIRE(_dependencyMap[0], \"../../flow_interfaces\");\n\n  var _operations = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"../../constants/operations\"));\n\n  var _utils = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"../../utils\"));\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n\n  function __processMessage(modules, message) {\n    var config = modules.config,\n        crypto = modules.crypto;\n    if (!config.cipherKey) return message;\n\n    try {\n      return crypto.decrypt(message);\n    } catch (e) {\n      return message;\n    }\n  }\n\n  function getOperation() {\n    return _operations[\"default\"].PNHistoryOperation;\n  }\n\n  function validateParams(modules, incomingParams) {\n    var channel = incomingParams.channel;\n    var config = modules.config;\n    if (!channel) return 'Missing channel';\n    if (!config.subscribeKey) return 'Missing Subscribe Key';\n  }\n\n  function getURL(modules, incomingParams) {\n    var channel = incomingParams.channel;\n    var config = modules.config;\n    return \"/v2/history/sub-key/\".concat(config.subscribeKey, \"/channel/\").concat(_utils[\"default\"].encodeString(channel));\n  }\n\n  function getRequestTimeout(_ref) {\n    var config = _ref.config;\n    return config.getTransactionTimeout();\n  }\n\n  function isAuthSupported() {\n    return true;\n  }\n\n  function prepareParams(modules, incomingParams) {\n    var start = incomingParams.start,\n        end = incomingParams.end,\n        reverse = incomingParams.reverse,\n        _incomingParams$count = incomingParams.count,\n        count = _incomingParams$count === void 0 ? 100 : _incomingParams$count,\n        _incomingParams$strin = incomingParams.stringifiedTimeToken,\n        stringifiedTimeToken = _incomingParams$strin === void 0 ? false : _incomingParams$strin,\n        _incomingParams$inclu = incomingParams.includeMeta,\n        includeMeta = _incomingParams$inclu === void 0 ? false : _incomingParams$inclu;\n    var outgoingParams = {\n      include_token: 'true'\n    };\n    outgoingParams.count = count;\n    if (start) outgoingParams.start = start;\n    if (end) outgoingParams.end = end;\n    if (stringifiedTimeToken) outgoingParams.string_message_token = 'true';\n    if (reverse != null) outgoingParams.reverse = reverse.toString();\n    if (includeMeta) outgoingParams.include_meta = 'true';\n    return outgoingParams;\n  }\n\n  function handleResponse(modules, serverResponse) {\n    var response = {\n      messages: [],\n      startTimeToken: serverResponse[1],\n      endTimeToken: serverResponse[2]\n    };\n\n    if (Array.isArray(serverResponse[0])) {\n      serverResponse[0].forEach(function (serverHistoryItem) {\n        var item = {\n          timetoken: serverHistoryItem.timetoken,\n          entry: __processMessage(modules, serverHistoryItem.message)\n        };\n\n        if (serverHistoryItem.meta) {\n          item.meta = serverHistoryItem.meta;\n        }\n\n        response.messages.push(item);\n      });\n    }\n\n    return response;\n  }\n});","lineCount":111,"map":[[2,0,1,0],[4,0,3,0,"Object"],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,0],[4,24,3,22,"exports"],[4,31,3,0],[4,33,3,31],[4,45,3,0],[4,47,3,45],[5,0,4,2,"value"],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,0,3,45],[6,3,3,0],[7,0,6,0,"exports"],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"getOperation"],[7,22,6,0],[7,25,6,23,"getOperation"],[7,37,6,0],[8,0,7,0,"exports"],[8,2,7,0,"exports"],[8,9,7,7],[8,10,7,8,"validateParams"],[8,24,7,0],[8,27,7,25,"validateParams"],[8,41,7,0],[9,0,8,0,"exports"],[9,2,8,0,"exports"],[9,9,8,7],[9,10,8,8,"getURL"],[9,16,8,0],[9,19,8,17,"getURL"],[9,25,8,0],[10,0,9,0,"exports"],[10,2,9,0,"exports"],[10,9,9,7],[10,10,9,8,"getRequestTimeout"],[10,27,9,0],[10,30,9,28,"getRequestTimeout"],[10,47,9,0],[11,0,10,0,"exports"],[11,2,10,0,"exports"],[11,9,10,7],[11,10,10,8,"isAuthSupported"],[11,25,10,0],[11,28,10,26,"isAuthSupported"],[11,43,10,0],[12,0,11,0,"exports"],[12,2,11,0,"exports"],[12,9,11,7],[12,10,11,8,"prepareParams"],[12,23,11,0],[12,26,11,24,"prepareParams"],[12,39,11,0],[13,0,12,0,"exports"],[13,2,12,0,"exports"],[13,9,12,7],[13,10,12,8,"handleResponse"],[13,24,12,0],[13,27,12,25,"handleResponse"],[13,41,12,0],[15,0,14,0],[15,6,14,4,"_flow_interfaces"],[15,22,14,20],[15,25,14,23,"require"],[15,36,14,30],[15,80,14,0],[17,0,16,0],[17,6,16,4,"_operations"],[17,17,16,15],[17,20,16,18,"_interopRequireDefault"],[17,42,16,40],[17,43,16,41,"require"],[17,54,16,48],[17,103,16,40],[17,104,16,0],[19,0,18,0],[19,6,18,4,"_utils"],[19,12,18,10],[19,15,18,13,"_interopRequireDefault"],[19,37,18,35],[19,38,18,36,"require"],[19,49,18,43],[19,83,18,35],[19,84,18,0],[21,0,20,0],[21,11,20,9,"_interopRequireDefault"],[21,33,20,0],[21,34,20,32,"obj"],[21,37,20,0],[21,39,20,37],[22,0,20,39],[22,11,20,46,"obj"],[22,14,20,49],[22,18,20,53,"obj"],[22,21,20,56],[22,22,20,57,"__esModule"],[22,32,20,46],[22,35,20,70,"obj"],[22,38,20,46],[22,41,20,76],[23,0,20,78],[23,17,20,89,"obj"],[24,0,20,76],[24,5,20,39],[25,0,20,97],[27,0,22,0],[27,11,22,9,"__processMessage"],[27,27,22,0],[27,28,22,26,"modules"],[27,35,22,0],[27,37,22,35,"message"],[27,44,22,0],[27,46,22,44],[28,0,23,2],[28,8,23,6,"config"],[28,14,23,12],[28,17,23,15,"modules"],[28,24,23,22],[28,25,23,23,"config"],[28,31,23,2],[29,0,23,2],[29,8,24,6,"crypto"],[29,14,24,12],[29,17,24,15,"modules"],[29,24,24,22],[29,25,24,23,"crypto"],[29,31,23,2],[30,0,25,2],[30,8,25,6],[30,9,25,7,"config"],[30,15,25,13],[30,16,25,14,"cipherKey"],[30,25,25,2],[30,27,25,25],[30,34,25,32,"message"],[30,41,25,25],[32,0,27,2],[32,8,27,6],[33,0,28,4],[33,13,28,11,"crypto"],[33,19,28,17],[33,20,28,18,"decrypt"],[33,27,28,11],[33,28,28,26,"message"],[33,35,28,11],[33,36,28,4],[34,0,29,3],[34,5,27,2],[34,6,29,4],[34,13,29,11,"e"],[34,14,29,4],[34,16,29,14],[35,0,30,4],[35,13,30,11,"message"],[35,20,30,4],[36,0,31,3],[37,0,32,1],[39,0,34,0],[39,11,34,9,"getOperation"],[39,23,34,0],[39,26,34,24],[40,0,35,2],[40,11,35,9,"_operations"],[40,22,35,20],[40,23,35,21],[40,32,35,20],[40,33,35,9],[40,34,35,32,"PNHistoryOperation"],[40,52,35,2],[41,0,36,1],[43,0,38,0],[43,11,38,9,"validateParams"],[43,25,38,0],[43,26,38,24,"modules"],[43,33,38,0],[43,35,38,33,"incomingParams"],[43,49,38,0],[43,51,38,49],[44,0,39,2],[44,8,39,6,"channel"],[44,15,39,13],[44,18,39,16,"incomingParams"],[44,32,39,30],[44,33,39,31,"channel"],[44,40,39,2],[45,0,40,2],[45,8,40,6,"config"],[45,14,40,12],[45,17,40,15,"modules"],[45,24,40,22],[45,25,40,23,"config"],[45,31,40,2],[46,0,41,2],[46,8,41,6],[46,9,41,7,"channel"],[46,16,41,2],[46,18,41,16],[46,25,41,23],[46,42,41,16],[47,0,42,2],[47,8,42,6],[47,9,42,7,"config"],[47,15,42,13],[47,16,42,14,"subscribeKey"],[47,28,42,2],[47,30,42,28],[47,37,42,35],[47,60,42,28],[48,0,43,1],[50,0,45,0],[50,11,45,9,"getURL"],[50,17,45,0],[50,18,45,16,"modules"],[50,25,45,0],[50,27,45,25,"incomingParams"],[50,41,45,0],[50,43,45,41],[51,0,46,2],[51,8,46,6,"channel"],[51,15,46,13],[51,18,46,16,"incomingParams"],[51,32,46,30],[51,33,46,31,"channel"],[51,40,46,2],[52,0,47,2],[52,8,47,6,"config"],[52,14,47,12],[52,17,47,15,"modules"],[52,24,47,22],[52,25,47,23,"config"],[52,31,47,2],[53,0,48,2],[53,11,48,9],[53,34,48,32,"concat"],[53,40,48,9],[53,41,48,39,"config"],[53,47,48,45],[53,48,48,46,"subscribeKey"],[53,60,48,9],[53,62,48,60],[53,73,48,9],[53,75,48,73,"concat"],[53,81,48,9],[53,82,48,80,"_utils"],[53,88,48,86],[53,89,48,87],[53,98,48,86],[53,99,48,80],[53,100,48,98,"encodeString"],[53,112,48,80],[53,113,48,111,"channel"],[53,120,48,80],[53,121,48,9],[53,122,48,2],[54,0,49,1],[56,0,51,0],[56,11,51,9,"getRequestTimeout"],[56,28,51,0],[56,29,51,27,"_ref"],[56,33,51,0],[56,35,51,33],[57,0,52,2],[57,8,52,6,"config"],[57,14,52,12],[57,17,52,15,"_ref"],[57,21,52,19],[57,22,52,20,"config"],[57,28,52,2],[58,0,53,2],[58,11,53,9,"config"],[58,17,53,15],[58,18,53,16,"getTransactionTimeout"],[58,39,53,9],[58,41,53,2],[59,0,54,1],[61,0,56,0],[61,11,56,9,"isAuthSupported"],[61,26,56,0],[61,29,56,27],[62,0,57,2],[62,11,57,9],[62,15,57,2],[63,0,58,1],[65,0,60,0],[65,11,60,9,"prepareParams"],[65,24,60,0],[65,25,60,23,"modules"],[65,32,60,0],[65,34,60,32,"incomingParams"],[65,48,60,0],[65,50,60,48],[66,0,61,2],[66,8,61,6,"start"],[66,13,61,11],[66,16,61,14,"incomingParams"],[66,30,61,28],[66,31,61,29,"start"],[66,36,61,2],[67,0,61,2],[67,8,62,6,"end"],[67,11,62,9],[67,14,62,12,"incomingParams"],[67,28,62,26],[67,29,62,27,"end"],[67,32,61,2],[68,0,61,2],[68,8,63,6,"reverse"],[68,15,63,13],[68,18,63,16,"incomingParams"],[68,32,63,30],[68,33,63,31,"reverse"],[68,40,61,2],[69,0,61,2],[69,8,64,6,"_incomingParams$count"],[69,29,64,27],[69,32,64,30,"incomingParams"],[69,46,64,44],[69,47,64,45,"count"],[69,52,61,2],[70,0,61,2],[70,8,65,6,"count"],[70,13,65,11],[70,16,65,14,"_incomingParams$count"],[70,37,65,35],[70,42,65,40],[70,47,65,45],[70,48,65,14],[70,51,65,49],[70,54,65,14],[70,57,65,55,"_incomingParams$count"],[70,78,61,2],[71,0,61,2],[71,8,66,6,"_incomingParams$strin"],[71,29,66,27],[71,32,66,30,"incomingParams"],[71,46,66,44],[71,47,66,45,"stringifiedTimeToken"],[71,67,61,2],[72,0,61,2],[72,8,67,6,"stringifiedTimeToken"],[72,28,67,26],[72,31,67,29,"_incomingParams$strin"],[72,52,67,50],[72,57,67,55],[72,62,67,60],[72,63,67,29],[72,66,67,64],[72,71,67,29],[72,74,67,72,"_incomingParams$strin"],[72,95,61,2],[73,0,61,2],[73,8,68,6,"_incomingParams$inclu"],[73,29,68,27],[73,32,68,30,"incomingParams"],[73,46,68,44],[73,47,68,45,"includeMeta"],[73,58,61,2],[74,0,61,2],[74,8,69,6,"includeMeta"],[74,19,69,17],[74,22,69,20,"_incomingParams$inclu"],[74,43,69,41],[74,48,69,46],[74,53,69,51],[74,54,69,20],[74,57,69,55],[74,62,69,20],[74,65,69,63,"_incomingParams$inclu"],[74,86,61,2],[75,0,70,2],[75,8,70,6,"outgoingParams"],[75,22,70,20],[75,25,70,23],[76,0,71,4,"include_token"],[76,6,71,4,"include_token"],[76,19,71,17],[76,21,71,19],[77,0,70,23],[77,5,70,2],[78,0,73,2,"outgoingParams"],[78,4,73,2,"outgoingParams"],[78,18,73,16],[78,19,73,17,"count"],[78,24,73,2],[78,27,73,25,"count"],[78,32,73,2],[79,0,74,2],[79,8,74,6,"start"],[79,13,74,2],[79,15,74,13,"outgoingParams"],[79,29,74,27],[79,30,74,28,"start"],[79,35,74,13],[79,38,74,36,"start"],[79,43,74,13],[80,0,75,2],[80,8,75,6,"end"],[80,11,75,2],[80,13,75,11,"outgoingParams"],[80,27,75,25],[80,28,75,26,"end"],[80,31,75,11],[80,34,75,32,"end"],[80,37,75,11],[81,0,76,2],[81,8,76,6,"stringifiedTimeToken"],[81,28,76,2],[81,30,76,28,"outgoingParams"],[81,44,76,42],[81,45,76,43,"string_message_token"],[81,65,76,28],[81,68,76,66],[81,74,76,28],[82,0,77,2],[82,8,77,6,"reverse"],[82,15,77,13],[82,19,77,17],[82,23,77,2],[82,25,77,23,"outgoingParams"],[82,39,77,37],[82,40,77,38,"reverse"],[82,47,77,23],[82,50,77,48,"reverse"],[82,57,77,55],[82,58,77,56,"toString"],[82,66,77,48],[82,68,77,23],[83,0,78,2],[83,8,78,6,"includeMeta"],[83,19,78,2],[83,21,78,19,"outgoingParams"],[83,35,78,33],[83,36,78,34,"include_meta"],[83,48,78,19],[83,51,78,49],[83,57,78,19],[84,0,79,2],[84,11,79,9,"outgoingParams"],[84,25,79,2],[85,0,80,1],[87,0,82,0],[87,11,82,9,"handleResponse"],[87,25,82,0],[87,26,82,24,"modules"],[87,33,82,0],[87,35,82,33,"serverResponse"],[87,49,82,0],[87,51,82,49],[88,0,83,2],[88,8,83,6,"response"],[88,16,83,14],[88,19,83,17],[89,0,84,4,"messages"],[89,6,84,4,"messages"],[89,14,84,12],[89,16,84,14],[89,18,83,17],[90,0,85,4,"startTimeToken"],[90,6,85,4,"startTimeToken"],[90,20,85,18],[90,22,85,20,"serverResponse"],[90,36,85,34],[90,37,85,35],[90,38,85,34],[90,39,83,17],[91,0,86,4,"endTimeToken"],[91,6,86,4,"endTimeToken"],[91,18,86,16],[91,20,86,18,"serverResponse"],[91,34,86,32],[91,35,86,33],[91,36,86,32],[92,0,83,17],[92,5,83,2],[94,0,89,2],[94,8,89,6,"Array"],[94,13,89,11],[94,14,89,12,"isArray"],[94,21,89,6],[94,22,89,20,"serverResponse"],[94,36,89,34],[94,37,89,35],[94,38,89,34],[94,39,89,6],[94,40,89,2],[94,42,89,40],[95,0,90,4,"serverResponse"],[95,6,90,4,"serverResponse"],[95,20,90,18],[95,21,90,19],[95,22,90,18],[95,23,90,4],[95,24,90,22,"forEach"],[95,31,90,4],[95,32,90,30],[95,42,90,40,"serverHistoryItem"],[95,59,90,30],[95,61,90,59],[96,0,91,6],[96,12,91,10,"item"],[96,16,91,14],[96,19,91,17],[97,0,92,8,"timetoken"],[97,10,92,8,"timetoken"],[97,19,92,17],[97,21,92,19,"serverHistoryItem"],[97,38,92,36],[97,39,92,37,"timetoken"],[97,48,91,17],[98,0,93,8,"entry"],[98,10,93,8,"entry"],[98,15,93,13],[98,17,93,15,"__processMessage"],[98,33,93,31],[98,34,93,32,"modules"],[98,41,93,31],[98,43,93,41,"serverHistoryItem"],[98,60,93,58],[98,61,93,59,"message"],[98,68,93,31],[99,0,91,17],[99,9,91,6],[101,0,96,6],[101,12,96,10,"serverHistoryItem"],[101,29,96,27],[101,30,96,28,"meta"],[101,34,96,6],[101,36,96,34],[102,0,97,8,"item"],[102,10,97,8,"item"],[102,14,97,12],[102,15,97,13,"meta"],[102,19,97,8],[102,22,97,20,"serverHistoryItem"],[102,39,97,37],[102,40,97,38,"meta"],[102,44,97,8],[103,0,98,7],[105,0,100,6,"response"],[105,8,100,6,"response"],[105,16,100,14],[105,17,100,15,"messages"],[105,25,100,6],[105,26,100,24,"push"],[105,30,100,6],[105,31,100,29,"item"],[105,35,100,6],[106,0,101,5],[106,7,90,4],[107,0,102,3],[109,0,104,2],[109,11,104,9,"response"],[109,19,104,2],[110,0,105,1]],"functionMap":{"names":["<global>","_interopRequireDefault","__processMessage","getOperation","validateParams","getURL","getRequestTimeout","isAuthSupported","prepareParams","handleResponse","serverResponse._.forEach$argument_0"],"mappings":"AAA;ACmB,iGD;AEE;CFU;AGE;CHE;AIE;CJK;AKE;CLI;AME;CNG;AOE;CPE;AQE;CRoB;ASE;8BCQ;KDW;CTI"}},"type":"js/module"}]}